# Snakemake workflow: quantum-monte-carlo
This workflow performs a quantum monte carlo (QMC) calculation using "trial" wave function (WFN)
generated by QCHEM and ORCA.

## Authors

* Vladimir Konjkov

## Usage

### Step 1: Install workflow and additional utilities

Download workflow from [repository](https://github.com/Konjkov/snakerules)

Download [molden2qmc.py](https://github.com/Konjkov/molden2qmc) utility required to convert "trial" WFN from MOLDEN output format to CASINO input format.

Download [multideterminant.py](https://github.com/Konjkov/molden2qmc) utility required to convert multi determinant information available in CASSCF and post-HF methods to CASINO format.

Copy them to the directory in the current path.

Choose program to generate "trial" WFN (QCHEM > 4.0 or ORCA 4.0.1) and install it.


### Step 2: Configure workflow

Configure the workflow according to your needs via editing the file `ORCA/Snakefile` or `QCHEM/Snakefile` depending on what program you will use.

The basic information necessary for calculations is contained in global variables:

* MOLECULES is a list of molecular geometry file names in xyz-format (without extension) located in the `chem_database` directory for which the calculation will be performed.

* METHODS is a list of quantum chemistry methods to obtain a "trial" WFN.

* BASES is a list of bases in which the trial function will be represented.

* JASTROW_RANKS is a filename of template (without extension) defining JASTROW factor

Depending on the program used to generate "trial" WFN, the following rules are available:

* __ORCA__
    * __ALL_ORCA__
        perform ORCA calculaction and generate gwfm.data file and correlation.data in case of CASSCF method.
    * __ALL_VMC__
        perform pure VMC calculation (without JASTROW), this rule intended to check whether the conversion of the "trial" WFN to the casino format is correct.
    * __ALL_VMC_OPT__
        perform JASTROW coefficients optimization using `opt_plan`
    * __ALL_VMC_OPT_ENERGY__
        perform VMC energy calculation with optimized JASTROW coefficients.
    * __ALL_VMC_DMC__
        perform FN-DMC energy calculation for desired accuracy (specified in the variable STD_ERR)
    * __ALL_VMC_OPT_BF__
        perform JASTROW coefficients optimization using `opt_plan` with BACKFLOW transformation.
    * __ALL_VMC_OPT_ENERGY_BF__
        perform VMC energy calculation with optimized JASTROW and BACKFLOW coefficients.
    * __ALL_VMC_DMC_BF__
        perform FN-DMC energy calculation for desired accuracy (specified in the variable STD_ERR) with BACKFLOW transformed WFN.

* __QCHEM__
    * __ALL_QCHEM__
        perform ORCA calculaction and generate gwfm.data file and correlation.data in case of OD, OD(2), VOD, VOD(2), QCCD, QCCD(2), VQCCD.
    * __ALL_VMC__
    * __ALL_VMC_OPT__
    * __ALL_VMC_OPT_ENERGY__
    * __ALL_VMC_DMC__
    * __ALL_VMC_OPT_BF__
    * __ALL_VMC_OPT_ENERGY_BF__
    * __ALL_VMC_DMC_BF__

### Step 3: Execute workflow

All you need to execute this workflow is to install Snakemake via the [Conda package manager](http://snakemake.readthedocs.io/en/stable/getting_started/installation.html#installation-via-conda). Software needed by this workflow is automatically deployed into isolated environments by Snakemake.

Test your configuration by performing a dry-run via

    snakemake <rule> -n

Execute the workflow locally via

    snakemake <rule>
